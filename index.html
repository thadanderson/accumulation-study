<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accumulation Study</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header>
    <h1>Accumulation Study</h1>
    <p class="subtitle">A generative process piece for open instrumentation</p>
  </header>

  <main>

    <!-- ── Controls ──────────────────────────────────────── -->
    <section id="controls">

      <div class="control-row">
        <label for="numPerformers">Performers</label>
        <input id="numPerformers" type="number" min="2" max="8" value="4" />
      </div>

      <div class="control-row">
        <label for="bpm">Tempo (BPM)</label>
        <input id="bpm" type="number" min="40" max="240" value="72" />
      </div>

      <div class="control-row">
        <label for="repsPerStep">Reps / Phase</label>
        <input id="repsPerStep" type="number" min="1" max="8" value="2" />
      </div>

      <!-- Phrase Builder -->
      <div id="phrase-builder">
        <div class="row-label">
          <span>Melodic Cell</span>
          <div class="phrase-actions">
            <button id="btn-random-phrase" type="button">Random</button>
            <button id="btn-clear-phrase"  type="button">Clear</button>
          </div>
        </div>
        <div class="scale-row">
          <label for="scale-select">Scale</label>
          <select id="scale-select">
            <optgroup label="Modes">
              <option value="C Major" selected>C Major (Ionian)</option>
              <option value="C Dorian">C Dorian</option>
              <option value="C Phrygian">C Phrygian</option>
              <option value="C Lydian">C Lydian</option>
              <option value="C Mixolydian">C Mixolydian</option>
              <option value="C Natural Minor">C Natural Minor (Aeolian)</option>
              <option value="C Locrian">C Locrian</option>
            </optgroup>
            <optgroup label="Minor Variants">
              <option value="C Harmonic Minor">C Harmonic Minor</option>
              <option value="C Melodic Minor">C Melodic Minor</option>
            </optgroup>
            <optgroup label="Pentatonic">
              <option value="C Major Pentatonic">C Major Pentatonic</option>
              <option value="C Minor Pentatonic">C Minor Pentatonic</option>
            </optgroup>
            <optgroup label="Symmetric &amp; Other">
              <option value="C Blues">C Blues</option>
              <option value="C Whole Tone">C Whole Tone</option>
              <option value="C Diminished">C Diminished (Octatonic)</option>
              <option value="Chromatic">Chromatic</option>
            </optgroup>
          </select>
        </div>
        <div id="note-palette"></div>
        <div id="phrase-preview"></div>
      </div>

      <div class="action-row">
        <button id="btn-generate" type="button" class="primary">Generate</button>
        <button id="btn-play"     type="button" class="primary" disabled>Play</button>
        <button id="btn-stop"     type="button"                 disabled>Stop</button>
      </div>

    </section>

    <!-- ── Score ─────────────────────────────────────────── -->
    <section id="score" hidden>
      <h2>Score</h2>
      <p id="score-header" class="score-header"></p>
      <div id="score-grid"></div>
    </section>

    <!-- ── Notation ──────────────────────────────────────── -->
    <section id="notation" hidden>
      <h2>Notation</h2>
      <div id="notation-container"></div>
    </section>

    <!-- ── Timeline ──────────────────────────────────────── -->
    <section id="timeline" hidden>
      <h2>Timeline</h2>
      <p id="phase-info" class="phase-info"></p>
      <div id="phase-chips"></div>
    </section>

  </main>

  <!-- Load order matters: utils → composition → stubs → main -->
  <script src="https://cdn.jsdelivr.net/npm/vexflow@4/build/cjs/vexflow.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tone@14/build/Tone.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/composition.js"></script>
  <script src="js/audio.js"></script>
  <script src="js/notation.js"></script>
  <script src="js/main.js"></script>

</body>
</html>
